# AmoCompanies — Компании

[Официальная документация AmoCRM, описание полей](https://www.amocrm.ru/developers/content/api/companies)

## Пример использования

Если `flatten = F` (дефолтное значение), то отдает лист с tidy-датафреймами, которые можно джойнить по `id`. 

Обращаться / джойнить можно следующим образом:

```r
library(amocrm)
# получение компаний
companies <- AmoCompanies(auth_list = auth_list)

# датафрейм с компаниями
companies_df <- companies$companies

# датафрейм со связанными дополнительными полями
companies_custom_fields <- companies$linked_custom_fields

# джойн двух датафреймов выше, на выходе строка будет соответствовать каждому значению доп. поля 
companies_with_custom_fields <- dplyr::left_join(companies_df, companies_custom_fields, by = "id")
```
## Параметры ответа

Лист | Описание
 --- | ---
companies | Компании
linked_custom_fields | Связанные дополнительные поля
linked_tags | Связанные теги
linked_leads | Связанные сделки
linked_contacts | Связанные контакты
linked_customers | Связанные покупатели

```r
> companies$linked_contacts

          id contact_id contact_idx
1    8407019   17598777           1
2    8371185   14208139           1
3    8506221   17785331           1
4    8974839   18330015           1
5    8724049   18036015           1
6    8724049   18274957           2
7    9506139   19012589           1
8    9483515   18988821           1
9   10348887   21138261           1
10  10153417   20890191           1
11  10153417   21068645           2
```

## Параметры запроса

Параметр | Описание
 --- | ---
email | **Обязательный**. Ваш e-mail. **Можно не указывать, если указан** `auth_list`.
apikey | **Обязательный**. Ваш API-ключ. **Можно не указывать, если указан** `auth_list`.
domain | **Обязательный**. Ваш поддомен. **Можно не указывать, если указан** `auth_list`.
auth_list | **Обязательный**. Лист с авторизационными данными, подробнее `?AmoAuthList`. **Можно не указывать, если указаны три параметра выше**.
limit | Батчинг запросов. По дефолту 500. Иногда AmoCRM API лагает и не отдает данные, в таких случаях можно попробовать уменьшить этот параметр.
flatten | Если `TRUE`, то делает `left_join` по всем датафреймам. Рекомендуется к использованию только при полном понимании того, что на выходе будет не tidy-датафрейм. Но все же стоит выгружать все листы и джойнить самим в R / BI-системе / БД / etc.
id | Фильтр. Выбрать элемент с заданным ID (если указан этот параметр, все остальные игнорируются). Можно передавать в виде вектора из ID.
query | Фильтр. Поисковый запрос (Осуществляет поиск по заполненым полям сущности).
responsible_user_id | Фильтр. Дополнительный фильтр поиска, по ответственному пользователю (можно передавать в виде вектора). ID можно получить в AmoUsers().
